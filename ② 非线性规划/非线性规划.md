# 非线性规划

## 模型概述

实际应用中，描述目标函数或约束条件的数学表达式中至少有一个是非线性函数的优化问题

> 非线性规划问题没有通用求解方法，各种方法有特定的适用范围、
>
> 非线性规划的算法一般只能给出局部最优解，不能保证是全局最优解

-----------

### 无约束非线性规划

形式：min f(x),  x∈R^n^

有局部最优解的必要条件：①f(x)具有连续的二阶偏导数；② **Hesse矩阵**为正定阵；③f(x)在x^*^处一阶偏导=0 → x^*^为局部最优解

>f(x)在x^*^处一阶偏导=0求解
>
>常用：最速降法、牛顿法、拟牛顿法
>

### 有约束非线性规划

处理思路：

1. **将非线性问题转化为线性问题**

> 非线性约束条件线性化：引入0-1变量
>
> 例：相互排斥的约束条件（多方案选择）
>
> > 如，有两种运输方式可供选择，海运运输或航空运输
> >
> > 引入0-1变量，统一在一个问题中：
> >
> > y = 0，当采取航空运输时
> >
> > ​      1，当采取海运运输时
> >
> > 根据0-1变量 y 构造合适的约束条件（有时需要引进充分大的常数M/充分小的常数ε）

2. **将约束问题转化为无约束问题**

> **① 只有等式约束：拉格朗日乘数法**
>
> > **形式：**
> >
> > min f(x)
> >
> > s.t.
> >
> > h~j~(x) = 0,       j = 1,2,...,q
> >
> > x ∈ R^n^
> >
> > **求解：**
> >
> > 拉格朗日定理：通过拉格朗日系数 λ 把等式约束和目标函数组合成为一个式子
> >
> > ① 函数f，h~j~（j = 1,2,...,q）在**可行点x^*^**的某个邻域N(x^*^, ε)内可微
> >
> > ② h~j~(x^*^)的一阶偏导构成的向量组线性无关
> >
> > 令 L(x, λ) = f(x) + λ^T^H(x)，其中 λ=[λ~1~，λ~2~，...，λ~q~]^T^ ∈ R^q^，H(x)=[h~1~(x)，h~2~(x)，...，h~q~(x)]^T^
> >
> > 若x^*^是局部最优解，则存在实向量 λ^*^ = [λ~1~^*^，λ~2~^*^，...，λ~q~^*^]^T^ ∈ R^q^，使得 L(x^*^, λ^*^) = 0
>
> **② 存在不等式约束：罚函数法**
>
> >**形式：**
> >
> >min f(x)
> >
> >s.t.
> >
> >g~i~(x) ≤ 0        i = 1,2,...,q
> >
> >h~j~(x) = 0,       j = 1,2,...,q
> >
> >x ∈ R^n^
> >
> >**求解：**
> >
> >罚函数法：利用目标函数和约束函数构造出**增广目标函数**，从而把有约束非线性规划问题转化为一系列无约束非线性规划问题
> >
> >外部罚函数法（外点法）：从非可行解出发逐渐移动到可行区域。迭代点在可行域的外部移动，随着迭代次数的增加，惩罚的力度越来越大，从而迫使迭代点向可行域靠近
> >
> >内部罚函数法（障碍罚函数法）：这种方法是在可行域内部进行搜索，如果当前解远离约束边界时，则罚函数值是非常小的，否则罚函数值接近无穷大
> >
> ><img src="C:\Users\liufangfei\AppData\Roaming\Typora\typora-user-images\image-20220730144030564.png" alt="image-20220730144030564" style="zoom:67%;" />
> >
> >```matlab
> >function g = fun(x);
> >% M充分大
> >M = 1e5; 
> >% 目标函数
> >f = x(1)^2+x(2)^2+8; 
> >% 结合约束条件构造的新目标函数
> >g = f-M*min(x(1),0)-M*min(x(2),0)-M*min(x(1)^2-x(2),0)+...
> >    M*abs(-x(1)-x(2)^2+2); 
> >
> >% 求解器
> >[x y] = fminunc('fun',rand(1,2))
> >```

### 凸规划

非线性规划：

min f(x)

s.t.

g~i~(x) ≤ 0        i = 1,2,...,q

h~j~(x) = 0,       j = 1,2,...,q

x ∈ R^n^

若f(x)为Ω上的凸函数，g~i~(x)为R^n^上的凸函数，h~j~(x)为R^n^上的线性函数，则称该非线性规划问题为凸规划

> **凸规划的性质：**
>
> 凸规划的可行域为凸集，其局部最优解即为全局最优解，且其最优解的几何形成一个凸集
>
> 当凸规划的目标函数f(x)为严格凸函数时，其最优解必定唯一

> **检验是否为凸规划：**
> 求非线性函数f(x)、g(x)的Hesse矩阵的行列式，若>0则为严格凸函数，=0则为凸函数
>
> 若为凸规划，求解器解出的x^*^即为全局最优解

> **库恩-塔克条件（K-T条件）**--- 确定非线性规划某点为最优点的**必要条件**

## 模型建立

min f(x)

s.t.

g~i~(x) ≤ 0        i = 1,2,...,q

h~j~(x) = 0,       j = 1,2,...,q

x ∈ R^n^

----------------

凸规划：基于问题求解 --- optimproblem（可得全局最优解）

无约束非线性规划：fminunc/fminsearch & 基于问题求解optimproblem

```matlab
[x,fval] = fminunc(f,x0)
```

有约束非线性规划：化为无约束（罚函数法）& fmincom & 基于问题求解optimproblem

> 基于求解器的非线性规划模型：
>
> min f(x)
>
> s.t.
>
> Ax ≤ b
>
> Aeq * x = beq
>
> c(x) ≤ 0
>
> ceq(x) = 0
>
> lb ≤ x ≤ ub

```matlab
% nonlcon 非线性向量函数c(x),ceq(x)
% options 优化参数
[x,fval] = fmincon(f,x0,A,b,Aeq,beq,lb,ub,nonlcon,options)
```

